#!/usr/bin/env bash

offset_x=30
offset_y=60

height=40

time=5

font_width=6
font="-*-cherry-*"

background="#EEEEEE"
foreground="#021B21"

send() {
    pkill -x notify

    echo "$1"
    sleep "$2"
}

while [[ $# -gt 0 ]]; do
    case "$1" in
        -t) time="$2";;
        -m) text="$2";;
    esac
    shift
    shift
done

# get notification width
text="%{c}${text}"
width=${#text}
width=$(( width * font_width ))

# get offset_x
res=$(bspc query -T -m | jq .rectangle.width)
offset_x=$(( res - offset_x - width))

send "$text" "$time" |\
    lemonbar \
    -g "${width}x${height}+${offset_x}+${offset_y}" \
    -B "$background" \
    -F "$foreground" \
    -f "$font" \
    -d &
