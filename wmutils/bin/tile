#!/bin/sh
#
# make master & stack
#
# wmutils

PANEL=${PANEL:-0}
GAP=${GAP:-0}

# get ids
id=$(pfw)
root=$(lsw -r)

# get values
bw=$(wattr b "$id")
nb=$(lsw | grep -cv "$id")

sw=$(wattr w "$root")
sh=$(wattr h "$root")

# get real size
sw=$((sw - GAP - 2 * bw))
sh=$((sh - GAP - PANEL))

# make the master
ms=$((sw * 2 / 3))
y=$((GAP + PANEL))

wtp "$GAP" "$y" "$((ms - GAP - 2 * bw))" "$((sh - GAP - 2 * bw))" "$id"

# make the stack
x=$((ms + GAP))
w=$((sw - ms - GAP))
h=$((sh / nb - GAP - 2 * bw))

for win in $(lsw | grep -v "$id"); do
    wtp "$x" "$y" "$w" "$h" "$win"
    y=$((y + h + GAP + 2 * bw))
done

# stolen from wmutils contrib
