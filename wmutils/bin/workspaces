#!/bin/sh
#
# manage workspaces
#
# wmutils

dir=/tmp/wmutils-ws

# if the current workspace is the one we want to focus
# exit to avoid screen flickering
cur=$(cat "$dir/current")
[ "$cur" = "$2" ] && exit

init() {
    mkdir -p "$dir"
    for i in $(seq 1 10); do
        touch "$dir/$i"
    done
    echo 1 > "$dir/current"
}

save() {
    lsw > "$dir/$1"
}

hide() {
    while read -r i; do
        mapw -tu "$i"
    done < "$dir/$1"
}

show() {
    while read -r i; do
        mapw -tm "$i"
    done < "$dir/$1"
}

send() {
    id=$(pfw)
    echo "$id" >> "$dir/$1"
    mapw -tu "$id"
}

case "$1" in
    "")
        init
        ;;
    send)
        send "$2"
        ;;
    show)
        save "$cur"
        hide "$cur"
        show "$2"
        echo "$2" > "$dir/current"
        ;;
esac
