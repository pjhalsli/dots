#!/bin/sh
#
# manage workspaces
#
# wmutils

dir=/tmp/wmutils-ws

! [ -e "$dir" ] || ! [ "$1" ] && {
    mkdir -p "$dir"
    for i in $(seq 1 "$WS"); do
        touch "$dir/$i"
    done
    echo 1 > "$dir/current"
}

save() {
    lsw > "$dir/$1"
}

flip() {
    while read -r i; do
        mapw -t "$i"
    done < "$dir/$1"
}

send() {
    id=$(pfw)
    echo "$id" >> "$dir/$1"
    mapw -u "$id"
}

cur=$(cat "$dir/current")
[ "$cur" = "$2" ] && exit

case "$1" in
    send)
        send "$2"
        ;;
    show)
        save "$cur"
        flip "$cur"
        flip "$2"
        echo "$2" > "$dir/current"
        ;;
esac
