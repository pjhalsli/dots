prompt() {
    local acc res var ret=$?

    # colors
    res='\[\e[m\]'

    ((ret)) && acc='\[\e[36m\]' || acc='\[\e[91m\]'

    # short path
    var=${PWD/#$HOME/\~}

    [[                             \
        $var =~ .*/.*/.*/.*     && \
        $var =~ (~?/[^/]*/).*(/.*) \
    ]] &&
        var=${BASH_REMATCH[1]}..${BASH_REMATCH[2]}

    # set prompt
    PS1="$acc$var$res "
}

PROMPT_COMMAND=prompt

# vim: ft=sh
