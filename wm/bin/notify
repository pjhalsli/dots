#!/bin/bash
#
# send a notification using lemonbar
#
# wm tool

# SETTINGS

height=40
offset_x=30
offset_y=60
time=5
font_size=6
font="-*-cherry-*"
background="#EEEEEE"
foreground="#021B21"

# SCRIPT

while [ "$#" -gt 0 ]; do
    case "$1" in
        -t) { shift; time="$1"; };;
        *) text="$1";;
    esac
    shift
done

# get notification width
width=$(echo "  $text  " | wc -m)
width=$(echo "$width * $font_size" | bc)

# get notification offset
res=$(bspc query -T -m | jq '.rectangle.width')
offset_x=$(echo "$res - $offset_x - $width" | bc)

# kill previous notification
pkill -f "lemonbar .* -d"

( echo "%{c}${text}"; sleep "$time"; ) |\
    lemonbar -g "${width}x${height}+${offset_x}+${offset_y}" \
    -B "$background" \
    -F "$foreground" \
    -f "$font" \
    -d &
