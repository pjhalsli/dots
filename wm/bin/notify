#!/bin/bash

# SETTINGS

# dimensions
height=40
offset_x=30
offset_y=60

# timeout
time=5

# theming
font_size=6
font="-*-cherry-*"
background="#EEEEEE"
foreground="#021B21"

# SCRIPT

get_width() {
    # take count of padding
    var=$(echo "  $text  " | wc -m)
    echo "$((var * font_size))"
}

get_offset() {
    var=$(bspc query -T -m | jq '.rectangle.width')
    echo "$((var - offset_x - width))"
}

while [ "$#" -gt 0 ]; do
    [ "$1" = -t ] && time="$2"
    [ "$1" = -m ] && text="$2"
    shift
    shift
done

width=$(get_width)
offset_x=$(get_offset)

(echo "%{c}${text}"; sleep "$time") |\
    lemonbar \
    -g "${width}x${height}+${offset_x}+${offset_y}" \
    -B "$background" \
    -F "$foreground" \
    -f "$font" \
    -d &
