#!/bin/sh
#
# send a notification using lemonbar
#
# wm tool

# SETTINGS

height=40
font_size=6
offset_x=30
offset_y=60
time=5

# SCRIPT

get_width() {
    # take padding into account
    var=$(echo "  $text  " | wc -m)
    echo "$((var * font_size))"
}

get_offset() {
    var=$(bspc query -T -m | jq '.rectangle.width')
    echo "$((var - offset_x - width))"
}

while [ "$#" -gt 0 ]; do
    case "$1" in
        -t) { shift; time="$1"; };;
        *) text="$1";;
    esac
    shift
done

# get offset & width
width=$(get_width)
offset_x=$(get_offset)

# kill previous notification
pkill -f "lemonbar .* -d"

( echo "%{c}${text}"; sleep "$time" ) |\
    lemonbar -g "${width}x${height}+${offset_x}+${offset_y}" \
    -f -*-cherry-* \
    -B \#EEEEEE \
    -F \#021B21 \
    -d &
