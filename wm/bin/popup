#!/usr/bin/env bash
#
# lemonbar popup
#
# wm script

name="popup"

# kill previous notification
pkill -f "lemonbar .* $name .*"

# source configuration
. ~/.config/popup/config

# get popup dimensions
var=$(bspc query -T -m)

x=$(echo "$var" | jq .rectangle.width)
y=$(echo "$var" | jq .rectangle.height)

read -r w h < <(txtf "$font" "$1")

w=$(( w + 2 * padding ))
h=$(( h + 2 * padding ))

off_x=$(( x - w - off_x ))
off_y=$(( y - h - off_y ))

{
    echo "%{c}$1"
    sleep "$time"
} | lemonbar -g "${w}x${h}+$off_x+$off_y" \
    -F "$foreground" \
    -B "$background" \
    -f "$font" \
    -n "$name" \
    -d &
