#!/bin/sh
#
# resize windows with bspwm
#
# wm key bindings

percent=10

# set a smaller percentage when floating
bspc query -N -n focused.floating > /dev/null &&
    percent=5

case $1 in
    west) dir=right; falldir=left; target=x; sign=-;;
    east) dir=right; falldir=left; target=x; sign=+;;
    north) dir=top; falldir=bottom; target=y; sign=-;;
    south) dir=top; falldir=bottom; target=y; sign=+;;
esac

# get resize value
var=$(bspc query -T -m | jq .rectangle.width)
var=$(( var * percent / 100 ))

[ "$target" = x ] && { x="$sign$var"; y=0; }
[ "$target" = y ] && { x=0; y="$sign$var"; }

# try to resize in one direction
# fallback to the other if it fails
bspc node -z "$dir" "$x" "$y" || bspc node -z "$falldir" "$x" "$y"
