#!/bin/sh
#
# external bspwm rules
#
# wm script

# spawn in preselections first
target=$(bspc query -N -d -n .\!automatic | head -1)
test "$target" && { echo "node=$target"; exit; }

# exit if there is no focused window
bspc query -T -n focused > /dev/null || exit

hori=east
vert=south

x=$(bspc query -T -n focused | jq .rectangle.width)
y=$(bspc query -T -n focused | jq .rectangle.height)

# split horizontally if x > y
# split vertically otherwise
[ "$x" -gt "$y" ] && split="$hori" || split="$vert"

echo "split_dir=$split"
