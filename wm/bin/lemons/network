# sourced by 'panel'

ntw ()
{
    # ensure network block isn't empty on startup
    { echo init; /sbin/iwevent 2> /dev/null; } | while read -r event; do
        case $event in
            init| *'New Access'*)

                # pattern matching
                case $event in
                    *'Not-Associated'*)
                        var=Disconnected
                        ;;
                    *'New Access'*)
                        # wait for a valid SSID
                        until /sbin/iwgetid > /dev/null; do
                            sleep .1
                        done

                        var=$(/sbin/iwgetid -r)
                        ;;
                    init)
                        var=$(/sbin/iwgetid -r)
                esac

                echo "N$aî„¿$t ${var:-Disconnected}"
        esac
    done
}

# vim: ft=sh
