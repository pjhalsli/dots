# sourced by 'panel'

ntw ()
{
    # add utils
    PATH=$PATH:/sbin

    # ensure network block isn't empty on startup
    { echo init; iwevent 2> /dev/null; } |
        while read -r event; do
            case $event in
                init|*'New Access'*)

                    # pattern matching
                    case $event in
                        *'Not-Associated'*)
                            var=Disconnected
                            ;;
                        *'New Access'*)
                            # wait for a valid SSID
                            until iwgetid > /dev/null; do
                                sleep .1
                            done

                            var=$(iwgetid -r)
                            ;;
                        init)
                            var=$(iwgetid -r)

                            var=${var:-Disconnected}
                    esac

                    echo "N$aî„¿$t $var"
            esac
        done
}

# vim: ft=sh
